# Storybook ガイドライン

## ストーリーを書く場合

**核心ルール**: **propsで制御される視覚的な分岐**に対してのみ、新しいストーリーを作成します。視覚的な違いがない場合や、propsで分岐を制御できない場合は、ストーリーを追加するのではなく、コンポーネントの分離方法を再検討する必要があります。

## ストーリー設定

### Metaオブジェクト設定
`meta`オブジェクトの設定は、コンポーネントの指定と、必要に応じた`args`の定義という、最小限の構成を基本とします。`title`や`parameters`といった追加の設定は、特別な要件がない限り省略してください。

### イベントハンドラー設定
`onClick`のようなイベントハンドラーをpropsに持つコンポーネントの場合、`args`プロパティで`fn()`関数を渡すことで、StorybookのUI上でインタラクションを記録できるようにします。

## ストーリー作成の指針

### ストーリーを複数作成する場合
コンポーネントがpropsを通じて複数の視覚的バリエーション（例: `primary`, `secondary`, `disabled`状態など）を持つ場合、そのバリエーションごとにストーリーを作成します。これにより、コンポーネントの各状態を一覧で確認できます。

### 単一ストーリーで十分な場合
コンポーネントにpropsで制御できるような視覚的な分岐が存在しない場合は、そのコンポーネントの基本的な表示を確認するための単一のストーリー（例: `Default`）があれば十分です。

### アンチパターン: 制御できない分岐
コンポーネントが内部に状態（例: `useState`によるローディング状態）を持ち、その状態を外部のpropsから制御できない場合、その状態ごとのストーリーを作成することはできません。これは不適切なコンポーネント設計の兆候であり、内部状態をpropsで制御できるようにコンポーネントをリファクタリング（分離）する必要があります。

## ストーリーの構成
- 意味のある視覚的な状態ごとに1つのストーリーを作成します。
- ストーリー名は、その視覚的な違いが明確にわかるように命名します。
- 関連するバリエーションは、Storybookの階層命名機能を使ってグループ化します。
- 空の状態や長いテキストなど、エッジケースを考慮したストーリーも作成します。

## 非視覚的ストーリーを避ける
**核心原則**: Storybookは視覚的確認のためのツールであり、ロジックテストのツールではありません。

### 回避すべき例
- コンポーネントが何もレンダリングしない状態（例: `isVisible: false`）のストーリー。
- 内部のフックや状態に依存し、外部から制御できないストーリー。
- 見た目が全く同じになる複数のストーリー。

### 代替手段
上記のような非視覚的なロジックや状態は、Storybookではなく、Vitestなどを用いた単体テストやスナップショットテストで検証してください。

## 警告サイン
以下のような状況に遭遇した場合、コンポーネントの分離が不十分である可能性が高いです。
1.  コンポーネントの特定の見た目を再現するストーリーが作れない。
2.  ストーリーを作るために、内部で使われているフックのモックが必要になる。
3.  複数のストーリーが、見た目上まったく同じになる。
4.  コンポーネントの内部状態をテストする必要がある。
5.  何も表示されないストーリーができてしまう。

これらの問題は、ロジックをコンポーネントから抽出し、propsで制御可能な設計にリファクタリングすることで解決できます。
