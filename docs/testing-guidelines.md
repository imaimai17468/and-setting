# テストガイドライン

## Vitest のインポート要件
**重要**: Vitestのテスト関数（`describe`, `test`, `expect`など）は、グローバルに利用できません。各テストファイルの先頭で、必ず`vitest`から明示的にインポートする必要があります。

## テストタイトルの日本語化
**重要**: すべてのテストタイトル（`describe`と`test`の第一引数）は、日本語で具体的に記述してください。これにより、コードレビューの効率とテスト内容の可読性が向上します。

テストタイトルには、テスト対象の条件となるprops名や変数名、そしてその具体的な値を明記します。「〜の場合、〜すること」や「〜の時、〜されること」といった形式で、テストの意図が明確に伝わるように記述してください。

## テストを書く場合
**核心ルール**: すべての条件ロジック（`if`文、三項演算子など）に対してテストを作成します。コード内に存在するすべての分岐パスを網羅することが目標です。

## テストの種類と目的

### ロジックテスト（単体テスト）
コンポーネントから抽出された純粋な関数や、propsでは制御できない複雑なビジネスロジックを対象とします。ロジックの正しさを検証することが目的です。テストが困難な場合は、ロジックがコンポーネントに密結合しているサインであり、ロジックを別の関数として抽出するリファクタリングを検討してください。

### コンポーネントテスト
propsによって表示や動作が変化するUIコンポーネントを対象とします。propsの様々な組み合わせに対して、コンポーネントが意図通りにレンダリングされるか、インタラクションが正しく機能するかを検証します。

### スナップショットテスト
HTMLの構造やARIA属性など、アクセシビリティに関わるセマンティックな構造が意図せず変更さ��ていないかを監視するために使用します。スタイリングの変更や動的なコンテンツのテストには不向きであり、それらの目的で使用してはいけません。

## テスト構造ルール

### テストの簡潔性と焦点
**核心ルール**: テストはシンプルに保ち、必須の条件ロジックのみに焦点を当てます。過度なテストや不必要な複雑さは避けてください。

### Arrange-Act-Assert (AAA) パターン
すべてのテストは、**Arrange（準備）**、**Act（実行）**、**Assert（検証）**の3つのステップで構成します。テストの可読性を高めるため、テスト対象の関数を実行した結果を`actual`、期待値を`expected`という変数名で定義することを推奨します。

### テスト構成の規則
1.  **`describe`のネスト禁止**: `describe`ブロックはネストせず、単一レベルでのみ使用します。
2.  **`test()`の使用**: 個別のテストケースには`it()`ではなく`test()`を使用します。
3.  **テストごとに1つの検証**: 1つの`test`ブロックでは、原則と��て1つのことだけを検証します（`expect`は1つ）。複数のプロパティを検証する場合は、オブジェクト比較を用います。
4.  **共通データの共有**: 複数のテストで共通するデータは、`describe`ブロックのスコープで定義します。
5.  **重要な分岐に集中**: 核心的なロジックの分岐に焦点を当て、自明なケースや過度なエッジケースのテストは避けます。
6.  **コメントの削除**: `Arrange`, `Act`, `Assert`のような自明なコメントは記述しません。

## テスト戦略
プロジェクトでは、ロジックテスト、コンポーネントテスト、スナップショットテスト、Storybookを組み合わせ、それぞれの目的に応じて使い分けます。将来的にはE2Eテストの導入も視野に入れます。

## テストカバレッジ目標
ロジック関数は100%、コンポーネントは重要な分岐を網羅し、プロジェクト全体で80%以上のカバレッジを目指します。

## AIエージェント向け重要な注意事項
テストファイルを作成・編集する前には、��ずユーザーの承認を得てください。その際、どのテスト戦略を用い、どのケースをカバーするのかを明確に計画として提示することが求められます。
